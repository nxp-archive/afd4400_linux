/*
 * Copyright (C) 2013 Freescale Semiconductor, Inc.
 *
 * The code contained herein is licensed under the GNU General Public
 * License. You may obtain a copy of the GNU General Public License
 * Version 2 or later at the following locations:
 *
 * http://www.opensource.org/licenses/gpl-license.html
 * http://www.gnu.org/copyleft/gpl.html
 */
/dts-v1/;

/include/ "d4400.dtsi"

/ {
	model = "D4400 Evaluation Board";
	compatible = "fsl,d4400";

	aliases {
		cpri0ethernet0 = &cp1_framer1;
		cpri0ethernet1 = &cp1_framer2;
		cpri1ethernet0 = &cp2_framer1;
		cpri1ethernet1 = &cp2_framer2;
	};

        memory {
                reg = <0x90000000 0x60000000>;
        };

        soc@0 {
                aips-bus@1000000 { /* AIPS1 */
                        uart4: serial@f8000 {
                                pinctrl-names = "default";
                                pinctrl-0 = <&pinctrl_uart4_1>;
                                status = "okay";
                        };
			ecspi@A4000 {
				#address-cells = <1>;
				#size-cells = <0>;
				status = "okay";
				pinctrl-names = "default";
				pinctrl-0 = <&pinctrl_ecspi1_1>;
				fsl,spi-num-chipselects = <3>;
			};

			ecspi@A8000 {
				#address-cells = <1>;
				#size-cells = <0>;
				status = "okay";
				pinctrl-names = "default";
				pinctrl-0 = <&pinctrl_ecspi2_1>;
				fsl,spi-num-chipselects = <2>;

			};

			ecspi@AC000 {
				#address-cells = <1>;
				#size-cells = <0>;
				status = "okay";
				pinctrl-names = "default";
				pinctrl-0 = <&pinctrl_ecspi3_1>;
				fsl,spi-num-chipselects = <3>;
			};

			ecspi@B4000 {
				#address-cells = <1>;
				#size-cells = <0>;
				status = "okay";
				pinctrl-names = "default";
				pinctrl-0 = <&pinctrl_ecspi5_1>;
				fsl,spi-num-chipselects = <1>;
			};
			ecspi@B8000 {
				#address-cells = <1>;
				#size-cells = <0>;
				status = "okay";
				pinctrl-names = "default";
				pinctrl-0 = <&pinctrl_ecspi6_1>;
				fsl,spi-num-chipselects = <4>;
			};

			ecspi@BC000 {
				#address-cells = <1>;
				#size-cells = <0>;
				status = "okay";
				pinctrl-names = "default";
				pinctrl-0 = <&pinctrl_ecspi7_1>;
				fsl,spi-num-chipselects = <2>;
			};

			ecspi@C0000 {
				#address-cells = <1>;
				#size-cells = <0>;
				status = "okay";
				pinctrl-names = "default";
				pinctrl-0 = <&pinctrl_ecspi8_1>;
				fsl,spi-num-chipselects = <3>;
			};

			i2c1: i2c@C4000 {
				#address-cells = <1>;
				#size-cells = <0>;
				status = "okay";
				pinctrl-names = "default";
				pinctrl-0 = <&pinctrl_i2c1_1>;

				pca9555: pca9555@24 {
					compatible = "nxp,pca9555";
					gpio-controller;
					#gpio-cells = <2>;
					reg = <0x24>;
				};

				cpriphy0: sfp0@50 {
					id = <0>;
					compatible = "sfp-dev";
					reg = <0x50 0x51>;
					max-addr = <0x2>;
					gpio-sfp-txdisable= <&pca9555 0 0>;
					gpio-sfp-txfault = <&pca9555 1 0>;
					gpio-sfp-prs = <&pca9555 2 0>;
					gpio-sfp-rxlos = <&pca9555 3 0>;
					};
			};

			i2c2: i2c@C8000 {
				#address-cells = <1>;
				#size-cells = <0>;
				status = "okay";
				pinctrl-names = "default";
				pinctrl-0 = <&pinctrl_i2c2_1>;

				cpriphy1: sfp1@50 {
					id = <1>;
					compatible = "sfp-dev";
					reg = <0x50 0x51>;
					max-addr = <0x2>;
					gpio-sfp-txdisable= <&pca9555 4 0>;
					gpio-sfp-txfault = <&pca9555 5 0>;
					gpio-sfp-prs = <&pca9555 6 0>;
					gpio-sfp-rxlos = <&pca9555 7 0>;
					};

			};

			i2c3: i2c@CC000 {
				#address-cells = <1>;
				#size-cells = <0>;
				status = "okay";
				pinctrl-names = "default";
				pinctrl-0 = <&pinctrl_i2c3_1>;

				cpriphy2: sfp2@50 {
					id = <2>;
					compatible = "sfp-dev";
					reg = <0x50 0x51>;
					max-addr = <0x2>;
					gpio-sfp-txdisable = <&pca9555 8 0>;
					gpio-sfp-txfault = <&pca9555 9 0>;
					gpio-sfp-prs = <&pca9555 10 0>;
					gpio-sfp-rxlos = <&pca9555 11 0>;
					};

			};

			cpri@0x100000 {
				/* Irq signal from I/O expander */
				sfp-plug-int = <&gpioA 15 0x0>;

				cp1_framer1: framer1@0x0 {
					reg = <0x0 0x8000>;
					framer-id = <0>;
					max-axcs = <24>;
					memblk-size = <0x1800>;
					local-mac-address = [ 00 00 AB CD 21 AB ];
					interrupts = <0 71 0x04>,
						<0 73 0x04>,
						<0 75 0x04>,
						<0 77 0x04>;
					sfp-handle = <&cpriphy0>;
					serdes-handle = <&serdes3 2>;
				};

				cp1_framer2: framer2@0x8000 {
					reg = <0x8000 0x8000>;
					framer-id = <1>;
					max-axcs = <24>;
					memblk-size = <0x1800>;
					local-mac-address = [ 00 00 AB CD 21 CD ];
					interrupts = <0 72 0x4>,
						<0 74 0x4>,
						<0 76 0x4>,
						<0 78 0x4>;
					sfp-handle = <&cpriphy1>;
					serdes-handle = <&serdes3 3>;
				};

			};
                };
                aips-bus@1200000 { /* AIPS2 */
                        #address-cells = <1>;
                        #size-cells = <1>;

			i2c5: i2c@DC000 {
				#address-cells = <1>;
				#size-cells = <0>;
				status = "okay";
				pinctrl-names = "default";
				pinctrl-0 = <&pinctrl_i2c5_1>;

				cpriphy3: sfp3@50 {
					id = <3>;
			      		compatible = "sfp-dev";
					reg = <0x50 0x51>;
					max-addr = <0x2>;
				      	gpio-sfp-txdisable = <&pca9555 12 0>;
				      	gpio-sfp-txfault = <&pca9555 13 0>;
			      		gpio-sfp-prs = <&pca9555 14 0>;
				      	gpio-sfp-rxlos = <&pca9555 15 0>;
			      	};

			};

			i2c10: i2c@F0000 {
				#address-cells = <1>;
				#size-cells = <0>;
				status = "okay";
				pinctrl-names = "default";
				pinctrl-0 = <&pinctrl_i2c10_1>;

				xcvr_roc1_eeprom: eeprom@50 {
					reg = <0x50>;
					compatible = "xcvr_eeprom";
					pagesize = <16>;
					bytesize = <256>;
				};
				xcvr_roc2_eeprom: eeprom@52 {
					reg = <0x52>;
					compatible = "xcvr_eeprom";
					pagesize = <16>;
					bytesize = <256>;
				};
				xcvr_wb_eeprom: eeprom@51 {
					reg = <0x51>;
					compatible = "xcvr_eeprom";
					pagesize = <128>;
					bytesize = <65536>;

				};
			};

			i2c11: i2c@F4000 {
				#address-cells = <1>;
				#size-cells = <0>;
				status = "okay";
				pinctrl-names = "default";
				pinctrl-0 = <&pinctrl_i2c11_1>;


				pca9555b: pca9555@24 {
					compatible = "nxp,pca9555";
					gpio-controller;
					#gpio-cells = <2>;
					reg = <0x24>;
				};

				i2c2spi: sc18is602@2f {
					compatible = "nxp,sc18is602";
					#address-cells = <1>;
					#size-cells = <0>;
					reg = <0x2f>;

					jcpll: ad9525@0 {
						compatible = "adi,ad9525";
						spi-max-frequency = <20000000>;
						reg = <0>;
					};
				};

				ina220@40 {
					compatible = "ti,ina220";
					reg = <0x40>;
					config = <0x04df>;
					shunt-uohms = <1000>;
				};

				adt7461@4c {
					compatible = "adi,adt7461";
					reg = <0x4c>;
				};

				eeprom@54 {
					compatible = "at24,24c02";
					pagesize = <16>;
					reg = <0x54>;
				};

				pca9547: pca9547@70 {
					compatible = "nxp,pca9547";
					reg = <0x70>;
					#address-cells = <1>;
					#size-cells = <0>;

					i2c@0 {
						#address-cells = <1>;
						#size-cells = <0>;
						reg = <0>;

						rtc:rtc@68{
							compatible = "dallas,ds3232";
							reg = <0x68>;
						};

					};
				};

				ir36021@78 {
					compatible = "ir,ir36021";
					reg = <0x78>;
				};
			};

			cpri@0x100000 {

				cp2_framer1: framer1@0x0 {
					reg = <0x0 0x8000>;
					framer-id = <0>;
					max-axcs = <24>;
					memblk-size = <0x1800>;
					local-mac-address = [ 00 00 AB CD 21 EF ];
					interrupts = <0 84 0x04>,
						<0 86 0x04>,
						<0 88 0x04>,
						<0 90 0x04>;
					sfp-handle = <&cpriphy2>;
					serdes-handle = <&serdes3 4>;
		                };

				cp2_framer2: framer2@0x8000 {
					reg = <0x8000 0x8000>;
					framer-id = <1>;
					max-axcs = <24>;
					memblk-size = <0x1800>;
					local-mac-address = [ 00 00 AB CD 22 AB ];
					interrupts = <0 85 0x4>,
						<0 87 0x4>,
						<0 89 0x4>,
						<0 91 0x4>;
					sfp-handle = <&cpriphy3>;
					serdes-handle = <&serdes3 5>;
				};

			};

		};

		aips-bus@4000000 { /* AIPS3 */

                        iomuxc@8c000 {

                                uart4 {
                                        pinctrl_uart4_1: uart4grp-1 {
                                                fsl,pins = <
                                                        350 0x80000000    /* D4400_PAD_UART4_TXD_UART_4_TXD */
                                                        356 0x80000000    /* D4400_PAD_UART4_RXD_UART_4_RXD */
                                                >;
                                        };
                                };
			};

			mdio@084000 {

				phy0: smsc-phy@0 {
					reg = <0>;
					device_type = "ethernet-phy";
				};

				phy2: vitesse-phy@2 {
					reg = <2>;
					device_type = "ethernet-phy";
				};

				tbi0: tbi-phy@10 {
					device_type = "tbi-phy";
					reg = <0x10>;
				};

				tbi1: tbi-phy@11 {
					device_type = "tbi-phy";
					reg = <0x11>;
				};
			};

			qspi@0A8000 {
				flash0: s25fl256s0@0 {
					#address-cells = <1>;
					#size-cells = <1>;
					compatible = "spansion,s25fl256s0";
					spi-max-frequency = <50000000>;
					io-mode = <4>; /* 1-single, 2-dual, 4-quad IO */

					partition@0 {
						/* U-Boot Image-512KB */
						reg = <0x0 0x00080000>;
						label = "bootloader";
						read-only;
					};
					partition@00080000 {
						/* Env variables, 256KB, area 1*/
						reg = <0x000080000 0x00040000>;
						label = "environment-1";
					};
					partition@000C0000 {
						/* Env variables, 256KB, area 2*/
						reg = <0x0000C0000 0x00040000>;
						label = "environment-2";
					};
					partition@00100000 {
						/* U-Boot Redundant Image-512KB */
						reg = <0x00100000 0x00080000>;
						label = "redundant-bootloader";
						read-only;
					};
					partition@00180000 {
						/* 28MB for JFFS2 based Root file System */
						reg = <0x00180000 0x01E80000>;
						label = "filesystem";
					};
				};
			};
		};
                weim-bus@30000000 {
                        nor_flash@0 {
                                compatible = "cfi-flash";
                                bank-width = <2>;
				/* 256MB of NOR Flash memory*/
                                reg = <0x00000000 0x08000000
					0x08000000 0x08000000>;
                                #address-cells = <1>;
                                #size-cells = <1>;
                                status = "okay";

                                partition@0 {
                                        /* This location must not be altered */
                                        /* NOR U-Boot Image-512KB */
                                        reg = <0x0 0x00080000>;
                                        label = "bootloader";
                                        read-only;
                                };
                                partition@00080000 {
                                        /* 128KB of env variables*/
                                        reg = <0x000080000 0x00020000>;
                                        label = "environment";
                                };
                                partition@000A0000 {
                                        /* 128KB of redundant env variables*/
                                        reg = <0x000A0000 0x00020000>;
                                        label = "redundant-environment";
                                };
                                partition@000C0000 {
                                        /* This location must not be altered */
                                        /* U-Boot Redundant Image-512KB */
                                        reg = <0x000C0000 0x00080000>;
                                        label = "bootloader";
                                        read-only;
                                };
                                partition@00140000 {
                                        /* 63 MB for Linux Kernel FIT Image */
                                        reg = <0x00140000 0x03F00000>;
                                        label = "kernel";
                                };
                                partition@04040000 {
                                        /* 63 MB for Linux Kernel FIT Redundant Image */
                                        reg = <0x04040000 0x03F00000>;
                                        label = "kernel";
                                };
                                partition@08000000 {
                                        /* 128MB for JFFS2 based Root file System */
                                        reg = <0x08000000 0x08000000>;
                                        label = "filesystem";
                                };
                    };

                    qixisfpga@10000000 {
                        compatible = "fsl,d4400-fpga";
                        #address-cells = <1>;
                        #size-cells = <1>;
                        status = "okay";
                        reg = <0x10000000 0xFF>;
			gpio-prsntb1 = <&pca9555b 8 0>;
			gpio-prsntb2 = <&pca9555b 9 0>;
			jcpll-handle = <&jcpll>;
                    };
                };

                xcvr_if: xcvr_if@1 {
			compatible = "fsl,xcvr-interface";

			xcvr-roc1 {
				#address-cells = <1>;
				#size-cells = <1>;
				platform-drv-name = "roc_misc_driver";
				/* FMC connector: 0-none, 1-fmc1, 2-fmc2, 3-fmc1 & fmc2 */
				connector-fmc = <1>;
				interrupt-parent = <&gpioA>;
				interrupts = <16 0x04>,
					<17 0x04>;
				id = <1>;
				cs-gpios = <&gpioC 16 0>,
					<&gpioC 18 0>,
					<&gpioC 19 0>;
				tx-reset = <3>;
				rx-reset = <5>;

				eeprom-handle =<&xcvr_roc1_eeprom>;
				ipmi-mfg-str = "Analog Devices";
				ipmi-name-str = "9368-2R1a,9525R0,9368-1R1a",
					"9368-2R1a,9525,9368-1R1a";
			};

			xcvr-roc2 {
				#address-cells = <1>;
				#size-cells = <1>;
				platform-drv-name = "roc_misc_driver";
				/* FMC connector: 0-none, 1-fmc1, 2-fmc2, 3-fmc1 & fmc2 */
				connector-fmc = <2>;
				interrupt-parent = <&gpioA>;
				interrupts = <18 0x04>,
					<19 0x04>;
				id = <2>;
				cs-gpios = <&gpioC 20 0>,
					<&gpioC 22 0>,
					<&gpioC 23 0>;
				tx-reset = <4>;
				rx-reset = <6>;

				eeprom-handle =<&xcvr_roc2_eeprom>;
				ipmi-mfg-str = "Analog Devices";
				ipmi-name-str = "9368-2R1a,9525R0,9368-1R1a",
					"9368-2R1a,9525,9368-1R1a";
			};

			wb-xcvr {
				#address-cells = <1>;
				#size-cells = <1>;
				platform-drv-name = "wb_misc_driver";
				/* FMC connector: 0-none, 1-fmc1, 2-fmc2, 3-fmc1 & fmc2 */
				connector-fmc = <3>;

				tx-reset = <4>;
				output-gpios = <&gpioC 22 0>,
					<&gpioC 23 0>,
					<&gpioC 16 0>,
					<&gpioC 17 0>,
					<&gpioC 18 0>,
					<&gpioC 19 0>,
					<&gpioD 6 0>,
					<&gpioC 7 0>;

				input-gpios = <&gpioC 8 0>,
					<&gpioC 9 0>,
					<&gpioC 10 0>,
					<&gpioC 11 0>,
					<&gpioA 22 0>,
					<&gpioA 23 0>,
					<&gpioA 20 0>,
					<&gpioA 21 0>;

				ad9680-spi-pins = <&gpioE 2 0>,
					<&gpioD 24 0>,
					<&gpioD 25 0>;

				eeprom-handle =<&xcvr_wb_eeprom>;
				ipmi-mfg-str = "Freescale";
				ipmi-name-str = "FSL Wideband transceiver R1.00";
			};

			wb2-xcvr {  /* 2.5GHz and 3.5GHz */
				#address-cells = <1>;
				#size-cells = <1>;
				platform-drv-name = "wb2_misc_driver";
				/* FMC connector: 0-none, 1-fmc1, 2-fmc2, 3-fmc1 & fmc2 */
				connector-fmc = <3>;

				tx-reset = <4>;
				output-gpios =
					<&gpioC 22 0>,
					<&gpioC 23 0>,
					<&gpioC 16 0>,
					<&gpioC 17 0>,
					<&gpioC 18 0>,
					<&gpioC 19 0>,
					<&gpioD 6 0>,
					<&gpioA 17 0>;

				input-gpios = <&gpioC 8 0>,
					<&gpioC 9 0>,
					<&gpioC 10 0>,
					<&gpioC 11 0>,
					<&gpioA 22 0>,
					<&gpioA 23 0>,
					<&gpioA 20 0>,
					<&gpioA 21 0>;

				ad9680-spi-pins =
					<&gpioE 2 0>,  /* sdio, spi2, 199 */
					<&gpioD 24 0>, /* sclk, spi2, 206 */
					<&gpioD 25 0>; /* ss0, spi2, 209 */

				/* PE43711 digital attenuator devices need extra pulse on LE signal */
				pe43711-ss-spi-pins =
					<&gpioD 30 0>, /* spi5 SRX ss0-256, gpioD_30-257 */
					<&gpioE 17 0>, /* spi7 TX1 ss0-295, gpioE_17-296 */
					<&gpioE 21 0>; /* spi8 TX2 ss0-316, gpioE_21-317 */

				/* LMX2492 PLL LO devices need extra pulse on LE signal */
				lmx2492-ss-spi-pins =
					<&gpioE 13 0>, /* spi6 DCC LO ss0-275, gpioE_13-276 */
					<&gpioE 27 0>, /* spi6 TX LO  ss1-279, gpioE_27-280 */
					<&gpioA 26 0>; /* spi6 SRX LO ss2-603, gpioA_26-602 */

				eeprom-handle =<&xcvr_wb_eeprom>;
				ipmi-mfg-str = "NXP";
				ipmi-name-str =
					"NXP Wideband2 2.5GHz R1.00",
					"NXP Wideband2 3.5GHz R1.00";
			};

                };

        };

	landshark@0xc000000 { /* LandShark */
		compatible = "fsl,landshark";
		address = <0xc0000000>;
		length = <0x10000000>;
		status = "okay";
	};
};

